.. raw:: latex

	\clearpage

.. _advanced-tricks:

Truques para tornar a vida mais fácil
=====================================

.. contents:: :local:

.. _advanced-tricks-botões-ordem:

Configurando a ordem dos botões
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

O MAME por predefinição já assume uma ordem para os botões de um
controle, porém nem sempre essa ordem estará na ordem dos botões
originais de um determinado sistema, sendo necessário a configuração
manual, os exemplos a seguir mostram como alterar essa ordem.

Veja :ref:`Alterando os valores <mamemenu-alt-valores>` antes de
prosseguir.

O processo é muito simples, inicie uma máquina qualquer como
``mame64 galaxian``, depois que a máquina iniciar pressione **TAB** e
selecione **Entrada (esta máquina)**, no campo **P1 BUTTON 1**
(primeiro botão de disparo/tiro do jogador 1) e defina o botão de tiro,
pressione **TAB** novamente para fechar a interface.

Depois de confirmar o funcionamento do botão, pressione **ESQ** para
encerrar a emulação e criar um arquivo ``galaxian.cfg`` no diretório
**cfg**.

.. raw:: latex

	\clearpage

.. _advanced-tricks-mais-de-um-botão:

Configurando mais de um botão
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Usando um controle de **Playstation 2** ligado no PC com um adaptador
USB como exemplo, faremos uma configuração de botões para máquinas
**Neo-Geo** executando o comando ``mame64 kof2000``, pressione **TAB**,
depois selecione **Entrada (esta máquina)** e configure os botões com a
ordem de sua preferência.

Dentro do diretório **cfg** será criado um arquivo chamado
``kof2000.cfg``, abra ele em um editor de texto qualquer, no topo do
arquivo modifique o ``<system name=kof2000>`` para
``<system name=default>`` e salve este arquivo no diretório **ctrlr**
como ``neogeo.cfg``. No nosso exemplo a ordem dos botões ficou assim, o
**quadrado** é **soco fraco**, o **triângulo** é **soco forte**, o
**xis** é **chute fraco** e o **círculo** é **chute forte**:

Baixe uma cópia deste arquivo no link ao lado https://pastebin.com/9Xp97xcd

.. code-block:: xml

	
    <?xml version="1.0"?>
    <!-- This file is autogenerated; comments and unknown tags will be stripped -->
    <mameconfig version="10">
    <system name="default">
        <input>
            <port tag=":edge:joy:JOY1" type="P1_BUTTON1" mask="16" defvalue="16">
                <newseq type="standard">
                    JOYCODE_1_BUTTON4
                </newseq>
            </port>
            <port tag=":edge:joy:JOY1" type="P1_BUTTON2" mask="32" defvalue="32">
                <newseq type="standard">
                    JOYCODE_1_BUTTON3
                </newseq>
            </port>
            <port tag=":edge:joy:JOY1" type="P1_BUTTON3" mask="64" defvalue="64">
                <newseq type="standard">
                    JOYCODE_1_BUTTON1
                </newseq>
            </port>
            <port tag=":edge:joy:JOY1" type="P1_BUTTON4" mask="128" defvalue="128">
                <newseq type="standard">
                    JOYCODE_1_BUTTON2
                </newseq>
            </port>
        </input>
      </system>
    </mameconfig>

Agora sempre que quiser usar essa configuração para os botões, basta
usar a opção :ref:`-ctrlr <mame-commandline-ctrlrpath>`, exemplo
``mame64 kof200 -ctrlr neogeo``, você pode também adicionar essa opção
ao seu **mame.ini** porém note que, essa configuração será aplicada em
todas as máquinas!

Para aplicar essa configuração apenas nas máquinas **Neo-Geo**, veja o
capítulo de :ref:`Configuração individual por sistema
<advanced-tricks-configuração-individual>`.

.. _advanced-tricks-botões-combinação:

Combinação de botões
~~~~~~~~~~~~~~~~~~~~

O personagem Zangief do **Street Fighter II** possui um golpe chamado
`Double Lariat <https://streetfighter.fandom.com/wiki/Double_Lariat>`_
que é ativado ao se pressionar os três botões de soco ao
**mesmo tempo**, é possível criar um arquivo de configuração para que
essa ação aconteça ao toque de um botão apenas.

Inicie o MAME com qualquer jogo da série ``mame64 sf2``, pressione
**TAB**, depois selecione **Entrada (esta máquina)**, ao configurar os
botões para os três socos, pressione **Delete** para apagar o valor,
logo depois escolha o botão que deseja ser soco fraco, pressione
**Enter** e escolha quase será o seu botão de **três socos**. Caso
tenha feito tudo certo, deverá aparecer algo como **Joy 1 button 0 or
Joy 1 button 1**, é muito importante aparecer o **OR** entre os botões.

Usando o mesmo controle de **Playstation 2** a ordem dos botões ficou
dessa forma, o **quadrado** é **soco fraco**, o **triângulo** é **soco
forte**, o **Xis** é **chute médio**, o **círculo** é **chute forte**, o
**L1** é **soco médio**, o **R1** é **chute fraco** e o botão **L2**
identificado como **JOYCODE_1_BUTTON5** faz o papel dos **três botões de
soco**:

Baixe uma cópia deste arquivo no link ao lado https://pastebin.com/p6dB9DMy

.. code-block:: xml

	
    <?xml version="1.0"?>
    <mameconfig version="10">
    <system name="default">
        <input>
            <port tag=":IN1" type="P1_BUTTON1" mask="16" defvalue="16">
                <newseq type="standard">
                    JOYCODE_1_BUTTON4 OR JOYCODE_1_BUTTON5
                </newseq>
            </port>
            <port tag=":IN1" type="P1_BUTTON2" mask="32" defvalue="32">
                <newseq type="standard">
                    JOYCODE_1_BUTTON7 OR JOYCODE_1_BUTTON5
                </newseq>
            </port>
            <port tag=":IN1" type="P1_BUTTON3" mask="64" defvalue="64">
                <newseq type="standard">
                    JOYCODE_1_BUTTON1 OR JOYCODE_1_BUTTON5
                </newseq>
            </port>
            <port tag=":IN2" type="P1_BUTTON4" mask="1" defvalue="1">
                <newseq type="standard">
                    JOYCODE_1_BUTTON8
                </newseq>
            </port>
            <port tag=":IN2" type="P1_BUTTON5" mask="2" defvalue="2">
                <newseq type="standard">
                    JOYCODE_1_BUTTON3
                </newseq>
            </port>
            <port tag=":IN2" type="P1_BUTTON6" mask="4" defvalue="4">
                <newseq type="standard">
                    JOYCODE_1_BUTTON2
                </newseq>
            </port>
        </input>
    </system>
    </mameconfig>

Uma nota quanto a configuração acima, ela foi feita no Linux (SDL) e
pode ser que no Windows a definição para o botão **L1** seja alternada
para o botão **L2**, porém basta redefini-lo no Windows ou alterná-lo
para um outro botão qualquer depois.

O mesmo tipo de configuração também se aplica para qualquer máquina,
cito por exemplo as máquinas rítmicas da série **Guitar Freaks**,
**Dance Dance Revolution**, **Beatmania** e tantas outras que em alguns
momentos, necessitam que mais de um botão seja acionado ao mesmo tempo.

Baixe um exemplo de configuração de controle para `Guitar Freaks
<https://pastebin.com/g1iXAB1E>`_ e `Dance Dance Revolution
<https://pastebin.com/rSc4kd5u>`_.

.. _advanced-tricks-configuração-individual:

Configuração individual por sistema
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

No diretório **ini** crie um diretório chamado **source** e dentro dele
crie um arquivo chamado ``neogeo.ini``. Neste arquivo nós configuraremos
os seguintes parâmetros:

*	Que a Bios seja a **UniBios v 3.3**
*	Que a minha configuração de controle chamada **neogeo**.
	seja sempre carregada.
*	Que o áudio tenha uma taxa de amostragem com **32000 Hz** [#]_
*	O filtro esteja ativo.
*	O prescale seja maior que **1**.
*	Que a proporção de tela seja mantida.

Assim temos as seguintes opções para o nosso ``neogeo.ini``:

.. code-block:: kconfig

	bios                      unibios33
	ctrlr                     neogeo
	samplerate                32000
	filter                    1
	prescale                  2
	keepaspect                1

Agora sempre que qualquer máquina **Neo-Geo** for iniciada ela sempre
usará estas configurações, todas as outras máquinas não relacionadas
com **Neo-Geo** usarão as configurações predefinidas pelo MAME sem haver
conflitos de configuração, assim como, não será mais necessário
especificar todas essas opções na linha de comando.

.. _advanced-tricks-dat-sistema:

Gerando arquivos DAT para serem usados com gerenciadores de ROMs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Arquivos DAT são usados por gerenciadores de ROMs como
`RomCenter (Windows) <http://romcenter.com/>`_,
`RomVault (Linux e Windows) <http://www.romvault.com/>`_,
`Romulus (Windows) <http://romulus.net63.net/>`_,
`Clrmamepro (Windows) <http://mamedev.emulab.it/clrmamepro/>`_ e
`Clrmamepro (Mac) <http://www.emulab.it/>`_ para aferir a validade de
cada arquivo existente dentro de um arquivo ROM identificando o CRC e
SHA1 de cada um.

Execute o MAME com o comando: ::

	mame64 -listxml >mame.xml

Baixe o `DatUtil <http://www.logiqx.com/Tools/DatUtil/>`_, extraia-o no
mesmo diretório do MAME e execute o comando: ::

	datutil mame.xml

Será gerado um arquivo ``datutil.dat``, agora para criar um DAT para um
sistema CPS1 (**cps1.dat**) compatível com o **Clrmamepro** faça o
comando: ::

	datutil.exe -G cps1.cpp -o cps1.dat -f cmp datutil.dat

O mesmo pode ser usado para criar um DAT para CPS2: ::

	datutil.exe -G cps2.cpp -o cps2.dat -f cmp datutil.dat

.. raw:: latex

	\clearpage

Neo-geo: ::

	datutil.exe -G neogeo.cpp -o neogeo.dat -f cmp datutil.dat

Para uma lista de Neo-Geo sem clones: ::

	datutil.exe -G neogeo.cpp -o neogeo.dat -r -f cmp datutil.dat

E assim por diante, para criar um DAT em formato **RomCenter** troque o
``cmp`` por ``rc``, para **RomCenter 2** use ``rc2`` e para criar um
arquivo XML genérico aceito pelos outros gerenciadores use ``gx`` ou
``generic``. Para mais informações sobre outros formatos leia o arquivo
**Readme.txt** que acompanha o DatUtil, para ver alguns outros exemplos
práticos do uso do DatUtil acesse `este link
<https://forum.recalbox.com/topic/4537/tutorial-datutil>`_.

Estes mesmos arquivos ``neogeo.dat``, ``cps2.dat`` e qualquer outro que
for criado poderá ser utilizado pelos gerenciadores de ROMs para
construir um ROM SET para cada um destes sistemas. É uma maneira muito
mais fácil de se separar as ROMs do que ter que fazer e
:ref:`usar scripts <pistola-separando-roms>`. No entanto, apesar de ser
mais fácil utilizar um gerenciador, repare que é bem genérico. O uso de
scripts permitem que a separação seja bem mais específica caso seja
necessário.

.. [#]	De acordo com `este post
		<https://vgmrips.net/forum/viewtopic.php?f=3&t=155>`_ o YM2610
		trabalha com uma taxa de amostragem de 18.5 kHz (18500 Hz), logo
		a configuração de 22050 Hz até 32000 Hz deva ser suficiente uma
		vez que a taxa de amostragem de áudio do MAME é predefinida em
		48 kHz ou 48000 Hz e essa alta taxa de amostragem não traz
		nenhum benefício para a emulação como já foi descrito em
		:ref:`-samplerate <mame-commandline-samplerate>`.
